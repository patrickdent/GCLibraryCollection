<h2>User Manageent</h2>

<table class="index">
  <thead>
    <tr>
      <th></th>
      <th>User Name</th>
      <th>sort name</th>
      <th>email</th>
      <th>phone</th>
      <th>notes</th>
      <th>address</th>
      <th>id</th>
      <th>do not lend</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @users.each do |u| %>
    <% role = "librarian" if u.has_role? :librarian %>
    <% role = "admin" if u.has_role? :admin %>
    <tr>
      <td><%= role if role %></td>
      <td><%= link_to (u.name || "user"), user_path(u.id) %></td>
      <td><%= u.sort_by %></td>
      <td><%= u.email %></td>
      <td><%= u.phone %></td>
      <td><%= u.notes %></td>
      <td><%= u.address %></td>
      <td><%= u.id %></td>
      <td><%= "X" if u.do_not_lend %></td>
      <td>
        <% if librarian_user? %>
            <%= link_to "Edit", edit_user_path(u) %>
        <% end %>
        <% if admin_user? && current_user != u %> 
            <%= link_to "Delete", user_path(u), method: :delete, data: {confirm: "Are you sure you want to delete this user?"} %> 
        <% end %>
      </td>
    </tr>
    <% end %>
  </tbody>
</table>
